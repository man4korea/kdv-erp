<!DOCTYPE html>
<!--
ğŸ“ test-auth-modules.html
KDV ì‹œìŠ¤í…œ - ì¸ì¦ ëª¨ë“ˆ ë¶„ë¦¬ í…ŒìŠ¤íŠ¸
Create at 250525_1920 Ver1.00
-->
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¸ì¦ ëª¨ë“ˆ ë¶„ë¦¬ í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-section {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .test-section h3 {
            margin-top: 0;
            color: #333;
        }
        .status {
            padding: 5px 10px;
            border-radius: 3px;
            display: inline-block;
            margin: 5px 0;
        }
        .status.success { background-color: #d4edda; color: #155724; }
        .status.error { background-color: #f8d7da; color: #721c24; }
        .status.info { background-color: #d1ecf1; color: #0c5460; }
        button {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            background-color: #007bff;
            color: white;
            cursor: pointer;
        }
        button:hover { background-color: #0056b3; }
        #testResults {
            height: 200px;
            overflow-y: auto;
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ” ì¸ì¦ ëª¨ë“ˆ ë¶„ë¦¬ í…ŒìŠ¤íŠ¸</h1>
        <p>auth-core.jsê°€ 3ê°œ ëª¨ë“ˆ(session, permissions, encryption)ë¡œ ì˜ ë¶„ë¦¬ë˜ì—ˆëŠ”ì§€ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤.</p>
        
        <div class="test-section">
            <h3>ğŸ“‹ ëª¨ë“ˆ ë¡œë“œ í…ŒìŠ¤íŠ¸</h3>
            <div id="moduleLoadStatus">í…ŒìŠ¤íŠ¸ ì¤€ë¹„ ì¤‘...</div>
            <button onclick="runModuleLoadTest()">ëª¨ë“ˆ ë¡œë“œ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
        </div>
        
        <div class="test-section">
            <h3>ğŸ”‘ ê¸°ë³¸ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</h3>
            <div id="basicFunctionStatus">í…ŒìŠ¤íŠ¸ ì¤€ë¹„ ì¤‘...</div>
            <button onclick="runBasicFunctionTest()">ê¸°ë³¸ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
        </div>
        
        <div class="test-section">
            <h3>ğŸ§ª í†µí•© í…ŒìŠ¤íŠ¸</h3>
            <div id="integrationStatus">í…ŒìŠ¤íŠ¸ ì¤€ë¹„ ì¤‘...</div>
            <button onclick="runIntegrationTest()">í†µí•© í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
        </div>
        
        <div class="test-section">
            <h3>ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼ ë¡œê·¸</h3>
            <div id="testResults"></div>
            <button onclick="clearTestResults()">ë¡œê·¸ ì§€ìš°ê¸°</button>
        </div>
    </div>

    <script type="module">
        // Firebase ì„¤ì •ì´ ì—†ì–´ì„œ ì‹¤ì œ ì¸ì¦ì€ ë¶ˆê°€í•˜ì§€ë§Œ, ëª¨ë“ˆ êµ¬ì¡° í…ŒìŠ¤íŠ¸ëŠ” ê°€ëŠ¥
        let testResults = [];
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            testResults.push(`[${timestamp}] ${message}`);
            
            const resultsDiv = document.getElementById('testResults');
            resultsDiv.innerHTML = testResults.join('\n');
            resultsDiv.scrollTop = resultsDiv.scrollHeight;
            
            console.log(message);
        }
        
        function updateStatus(elementId, message, type = 'info') {
            const element = document.getElementById(elementId);
            element.innerHTML = `<span class="status ${type}">${message}</span>`;
        }
        
        // ëª¨ë“ˆ ë¡œë“œ í…ŒìŠ¤íŠ¸
        window.runModuleLoadTest = async function() {
            log('=== ëª¨ë“ˆ ë¡œë“œ í…ŒìŠ¤íŠ¸ ì‹œì‘ ===');
            
            try {
                // ê°œë³„ ëª¨ë“ˆë“¤ í…ŒìŠ¤íŠ¸
                const { SessionManager } = await import('./js/auth-session.js');
                log('âœ… auth-session.js ë¡œë“œ ì„±ê³µ');
                
                const { PermissionsManager } = await import('./js/auth-permissions.js');
                log('âœ… auth-permissions.js ë¡œë“œ ì„±ê³µ');
                
                const { EncryptionManager } = await import('./js/auth-encryption.js');
                log('âœ… auth-encryption.js ë¡œë“œ ì„±ê³µ');
                
                // í†µí•© ëª¨ë“ˆ í…ŒìŠ¤íŠ¸
                const { LoginManager } = await import('./js/auth-core.js');
                log('âœ… auth-core.js (í†µí•© ëª¨ë“ˆ) ë¡œë“œ ì„±ê³µ');
                
                // ê¸°ì¡´ ì¸í„°í˜ì´ìŠ¤ í…ŒìŠ¤íŠ¸
                const { AuthSystem } = await import('./js/auth.js');
                log('âœ… auth.js (ê¸°ì¡´ ì¸í„°í˜ì´ìŠ¤) ë¡œë“œ ì„±ê³µ');
                
                updateStatus('moduleLoadStatus', 'ëª¨ë“  ëª¨ë“ˆ ë¡œë“œ ì„±ê³µ!', 'success');
                
            } catch (error) {
                log(`âŒ ëª¨ë“ˆ ë¡œë“œ ì‹¤íŒ¨: ${error.message}`, 'error');
                updateStatus('moduleLoadStatus', `ëª¨ë“ˆ ë¡œë“œ ì‹¤íŒ¨: ${error.message}`, 'error');
            }
        };
        
        // ê¸°ë³¸ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
        window.runBasicFunctionTest = async function() {
            log('=== ê¸°ë³¸ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ ì‹œì‘ ===');
            
            try {
                const { LoginManager } = await import('./js/auth-core.js');
                const loginManager = new LoginManager();
                
                // ì¸ìŠ¤í„´ìŠ¤ ìƒì„± í…ŒìŠ¤íŠ¸
                log('âœ… LoginManager ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ì„±ê³µ');
                
                // ë©”ì„œë“œ ì¡´ì¬ í™•ì¸
                const methods = ['login', 'logout', 'getCurrentUser', 'checkExistingSession', 'sendPasswordReset'];
                methods.forEach(method => {
                    if (typeof loginManager[method] === 'function') {
                        log(`âœ… ${method} ë©”ì„œë“œ ì¡´ì¬ í™•ì¸`);
                    } else {
                        throw new Error(`${method} ë©”ì„œë“œê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŒ`);
                    }
                });
                
                // ìƒˆë¡œìš´ ê¶Œí•œ ê´€ë ¨ ë©”ì„œë“œ í™•ì¸
                const newMethods = ['isAdmin', 'hasPermission', 'getUserPermissions', 'getSecurityLogs'];
                newMethods.forEach(method => {
                    if (typeof loginManager[method] === 'function') {
                        log(`âœ… ìƒˆë¡œìš´ ë©”ì„œë“œ ${method} ì¡´ì¬ í™•ì¸`);
                    } else {
                        log(`âš ï¸ ìƒˆë¡œìš´ ë©”ì„œë“œ ${method} ì—†ìŒ (ì •ìƒ)`);
                    }
                });
                
                updateStatus('basicFunctionStatus', 'ê¸°ë³¸ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ ì„±ê³µ!', 'success');
                
            } catch (error) {
                log(`âŒ ê¸°ë³¸ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}`, 'error');
                updateStatus('basicFunctionStatus', `ê¸°ë³¸ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}`, 'error');
            }
        };
        
        // í†µí•© í…ŒìŠ¤íŠ¸
        window.runIntegrationTest = async function() {
            log('=== í†µí•© í…ŒìŠ¤íŠ¸ ì‹œì‘ ===');
            
            try {
                const { AuthSystem } = await import('./js/auth.js');
                const authSystem = new AuthSystem();
                
                // AuthSystem ì¸ìŠ¤í„´ìŠ¤ ìƒì„± í…ŒìŠ¤íŠ¸
                log('âœ… AuthSystem ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ì„±ê³µ');
                
                // ê¸°ì¡´ ë©”ì„œë“œë“¤ì´ ëª¨ë‘ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
                const coreMethos = ['login', 'logout', 'getCurrentUser', 'checkExistingSession'];
                coreMethos.forEach(method => {
                    if (typeof authSystem[method] === 'function') {
                        log(`âœ… AuthSystem.${method} ë©”ì„œë“œ ì¡´ì¬`);
                    } else {
                        throw new Error(`AuthSystem.${method} ë©”ì„œë“œê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŒ`);
                    }
                });
                
                // getCurrentUser ë©”ì„œë“œ ì‹¤í–‰ í…ŒìŠ¤íŠ¸ (ë¡œê·¸ì¸ ì•ˆ ëœ ìƒíƒœ)
                const currentUser = authSystem.getCurrentUser();
                log(`âœ… getCurrentUser() ì‹¤í–‰ ê²°ê³¼: ${JSON.stringify(currentUser)}`);
                
                // ì „ì—­ ê°ì²´ í™•ì¸
                if (window.authSystem) {
                    log('âœ… ì „ì—­ authSystem ê°ì²´ ì¡´ì¬ í™•ì¸');
                } else {
                    log('âš ï¸ ì „ì—­ authSystem ê°ì²´ ì—†ìŒ');
                }
                
                if (window.LoginManager) {
                    log('âœ… ì „ì—­ LoginManager í´ë˜ìŠ¤ ì¡´ì¬ í™•ì¸');
                } else {
                    log('âš ï¸ ì „ì—­ LoginManager í´ë˜ìŠ¤ ì—†ìŒ');
                }
                
                updateStatus('integrationStatus', 'í†µí•© í…ŒìŠ¤íŠ¸ ì„±ê³µ!', 'success');
                
            } catch (error) {
                log(`âŒ í†µí•© í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}`, 'error');
                updateStatus('integrationStatus', `í†µí•© í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}`, 'error');
            }
        };
        
        // ë¡œê·¸ ì§€ìš°ê¸°
        window.clearTestResults = function() {
            testResults = [];
            document.getElementById('testResults').innerHTML = '';
        };
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
        window.addEventListener('DOMContentLoaded', () => {
            log('ğŸš€ ì¸ì¦ ëª¨ë“ˆ ë¶„ë¦¬ í…ŒìŠ¤íŠ¸ í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ');
            log('Firebase ì„¤ì •ì´ ì—†ì–´ ì‹¤ì œ ì¸ì¦ì€ ë¶ˆê°€í•˜ì§€ë§Œ, ëª¨ë“ˆ êµ¬ì¡° í…ŒìŠ¤íŠ¸ëŠ” ê°€ëŠ¥í•©ë‹ˆë‹¤.');
        });
        
    </script>
</body>
</html>
